<!--pages/hotel/order/index.wxml-->
<!--
 | 订单列表页面
 |-->


<view class='container theme-container'>
	<view class="tab-bar flex_row_center theme-font1 theme7">
		<view class="tab all {{order_status == 0 ? 'selecte' :''}}" bindtap="swichOrderList" data-order_status="0">全部订单</view>
		<view class="tab pending {{order_status == 1 ? 'selecte' :''}}" bindtap="swichOrderList" data-order_status="1">待处理</view>
		<view class="tab completed {{order_status == 2 ? 'selecte' :''}}" bindtap="swichOrderList" data-order_status="2">已完成</view>
	</view>

	<!-- 全部订单 -->
	<scroll-view wx:if="{{order_status == '0'}}" class="scroll-view" scroll-y="true" scroll-with-animation="true" bindscrolltolower="loadMore">
		<view class="list all">
			<block wx:for="{{all_order_list}}" wx:for-item="bean" wx:key="key" wx:for-index="index">
				<view class="row flex_column_center_spaceBetween theme7 bottom-space">
					<view class="head flex_row_center_spaceBetween theme-font8">
						<view>{{bean.add_time}}</view>
            <view>{{bean.status_str}}</view>
					</view>
					<view class="body flex_row_center_spaceBetween">
						<view bindtap="gotoOrderDetail" data-order_id="{{bean.order_id}}" class="left flex_row_center" wx:if="{{bean.goods.length==1}}">
							<image bindtap="gotoDishDetail" data-goods_id="{{bean.goods_id}}" class="pic" mode="aspectFill" src="{{bean.goods_img}}"></image>
						</view>
						<view bindtap="gotoOrderDetail" data-order_id="{{bean.order_id}}" class="center flex_column_center_center" wx:if="{{bean.goods.length==1}}">
							<view class="one-line-overflow theme-font1">{{bean.goods_name}}</view>
						</view>

						<view class="left multiple-goods flex_row_center" wx:if="{{bean.goods.length>1}}">
							<block wx:for="{{bean.goods}}" wx:key="kk" wx:for-item="item" wx:for-index="idx">
								<image wx:if="{{idx<4}}" bindtap="gotoDishDetail" data-goods_id="{{item.id}}" class="pic" mode="aspectFill" src="{{item.img}}"></image>
							</block>
						</view>
						<view bindtap="gotoOrderDetail" data-order_id="{{bean.order_id}}" class="center multiple-goods flex_column_center_center" wx:if="{{bean.goods.length>1}}">
							<view class="fa fa-chevron-circle-right fa-lg theme-font3" aria-hidden="true"></view>
						</view>


						<view class="right flex_column_center_center">
							<view class="price theme-font1">￥{{bean.price}}</view>
							<view class="count theme-font3">共{{bean.amount}}件</view>
						</view>
					</view>
					<view class="important">
						<view class="flex_row_center theme-font7">
							<view>{{bean.contact}}</view>
							<button bindtap='phonecallevent' data-tel="{{bean.phone}}">{{bean.phone}}</button>
						</view>
						<view class="four-line-overflow theme-font7">{{bean.address}}</view>
						<view class="theme-font8">希望送达时间: {{bean.delivery_time}}</view>
					</view>
					<view class="foot flex_row_center_spaceBetween">
						<view class="order-number theme-font3">订单号: {{bean.order_id}}</view>
						<block wx:if="{{bean.status==1}}">
						<view bindtap="deal_order" data-order_id="{{bean.order_id}}" class="btn pending theme-button-welcome" wx:if="{{bean.status==1}}" data-keys="{{index}}">处理</view>
            </block>
						<block wx:elif="{{bean.status==13}}">
						<view class="btn-group flex_row_center_spaceBetween" wx:if="{{bean.status==13}}">
							<view class="btn order-untaking theme-button-welcome-dark" bindtap="orderReceive" data-action="2" data-keys="{{index}}" data-order_id="{{bean.order_id}}" data-delivery_type="{{bean.delivery_type}}">不接单</view>
							<view class="btn order-taking theme-button-welcome" bindtap="orderReceive" data-action="1" data-keys="{{index}}" data-order_id="{{bean.order_id}}" data-delivery_type="{{bean.delivery_type}}">接单</view>
						</view>
            </block>
					</view>
				</view>

			</block>

		</view>
	</scroll-view>

	<!-- 待处理订单 -->
	<scroll-view wx:if="{{order_status == '1'}}" class="scroll-view" scroll-y="true" scroll-with-animation="true" bindscrolltolower="loadMore">
		<view class="list all">
			<block wx:for="{{deal_order_list}}" wx:for-item="bean" wx:key="key" wx:for-index="index">
				<view class="row flex_column_center_spaceBetween theme7 bottom-space">
					<view class="head flex_row_center_spaceBetween theme-font8">
						<view>{{bean.add_time}}</view>
						<view>{{bean.status_str}}</view>
					</view>
					<view class="body flex_row_center_spaceBetween">
						<view bindtap="gotoOrderDetail" data-order_id="{{bean.order_id}}" class="left flex_row_center" wx:if="{{bean.goods.length==1}}">
							<image bindtap="gotoDishDetail" data-goods_id="{{bean.goods_id}}" class="pic" mode="aspectFill" src="{{bean.goods_img}}"></image>
						</view>
						<view bindtap="gotoOrderDetail" data-order_id="{{bean.order_id}}" class="center flex_column_center_center" wx:if="{{bean.goods.length==1}}">
							<view class="one-line-overflow theme-font1">{{bean.goods_name}}</view>
						</view>

						<view class="left multiple-goods flex_row_center" wx:if="{{bean.goods.length>1}}">
							<block wx:for="{{bean.goods}}" wx:key="kk" wx:for-item="item" wx:for-index="idx">
								<image wx:if="{{idx<4}}" bindtap="gotoDishDetail" data-goods_id="{{item.id}}" class="pic" mode="aspectFill" src="{{item.img}}"></image>
							</block>
						</view>
						<view bindtap="gotoOrderDetail" data-order_id="{{bean.order_id}}" class="center multiple-goods flex_column_center_center" wx:if="{{bean.goods.length>1}}">
							<view class="fa fa-chevron-circle-right fa-lg theme-font3" aria-hidden="true"></view>
						</view>
						<view class="right flex_column_center_center">
							<view class="price theme-font1">￥{{bean.price}}</view>
							<view class="count theme-font3">共{{bean.amount}}件</view>
						</view>
					</view>
					<view class="important">
						<view class="flex_row_center theme-font7">
							<view>{{bean.contact}}</view>
							<button bindtap='phonecallevent' data-tel="{{bean.phone}}">{{bean.phone}}</button>
						</view>
						<view class="four-line-overflow theme-font7">{{bean.address}}</view>
						<view class="theme-font8">希望送达时间: {{bean.delivery_time}}</view>
					</view>
					<view class="foot flex_row_center_spaceBetween">
						<view class="order-number theme-font3">订单号: {{bean.order_id}}</view>
						<block wx:if="{{bean.status==1}}">
						  <view bindtap="deal_order" data-order_id="{{bean.order_id}}" class="btn pending theme-button-welcome" wx:if="{{bean.status==1}}" data-keys="{{index}}">处理</view>
						</block>
            <block wx:elif="{{bean.status==13}}">
						<view class="btn-group flex_row_center_spaceBetween" wx:if="{{bean.status==13}}">
							<view class="btn order-untaking theme-button-welcome-dark" bindtap="orderReceive" data-action="2" data-keys="{{index}}" data-order_id="{{bean.order_id}}" data-delivery_type="{{bean.delivery_type}}">不接单</view>
							<view class="btn order-taking theme-button-welcome" bindtap="orderReceive" data-action="1" data-keys="{{index}}" data-order_id="{{bean.order_id}}" data-delivery_type="{{bean.delivery_type}}">接单</view>
						</view>
            </block>
					</view>
				</view>

			</block>


		</view>
	</scroll-view>

	<!-- 已完成订单 -->
	<scroll-view wx:if="{{order_status == '2'}}" class="scroll-view" scroll-y="true" scroll-with-animation="true" bindscrolltolower="loadMore">
		<view class="list all">
			<block wx:for="{{complete_order_list}}" wx:for-item="bean" wx:key="key" wx:for-index="index">
				<view class="row flex_column_center_spaceBetween theme7 bottom-space">
					<view class="head flex_row_center_spaceBetween theme-font8">
						<view>{{bean.add_time}}</view>
						<view>{{bean.status_str}}</view>
					</view>
					<view class="body flex_row_center_spaceBetween">
						<view bindtap="gotoOrderDetail" data-order_id="{{bean.order_id}}" class="left flex_row_center" wx:if="{{bean.goods.length==1}}">
							<image bindtap="gotoDishDetail" data-goods_id="{{bean.goods_id}}" class="pic" mode="aspectFill" src="{{bean.goods_img}}"></image>
						</view>
						<view bindtap="gotoOrderDetail" data-order_id="{{bean.order_id}}" class="center flex_column_center_center" wx:if="{{bean.goods.length==1}}">
							<view class="one-line-overflow theme-font1">{{bean.goods_name}}</view>
						</view>

						<view class="left multiple-goods flex_row_center" wx:if="{{bean.goods.length>1}}">
							<block wx:for="{{bean.goods}}" wx:key="kk" wx:for-item="item" wx:for-index="idx">
								<image wx:if="{{idx<4}}" bindtap="gotoDishDetail" data-goods_id="{{item.id}}" class="pic" mode="aspectFill" src="{{item.img}}"></image>
							</block>
						</view>
						<view bindtap="gotoOrderDetail" data-order_id="{{bean.order_id}}" class="center multiple-goods flex_column_center_center" wx:if="{{bean.goods.length>1}}">
							<view class="fa fa-chevron-circle-right fa-lg theme-font3" aria-hidden="true"></view>
						</view>
						<view class="right flex_column_center_center">
							<view class="price theme-font1">￥{{bean.price}}</view>
							<view class="count theme-font3">共{{bean.amount}}件</view>
						</view>
					</view>
					<view class="important">
						<view class="flex_row_center theme-font7">
							<view>{{bean.contact}}</view>
							<button bindtap='phonecallevent' data-tel="{{bean.phone}}">{{bean.phone}}</button>
						</view>
						<view class="four-line-overflow theme-font7">{{bean.address}}</view>
						<view class="theme-font8">希望送达时间: {{bean.delivery_time}}</view>
					</view>
					<view class="foot flex_row_center_spaceBetween">
						<view class="order-number theme-font3">订单号: {{bean.order_id}}</view>
						<!-- <view bindtap="deal_order" data-order_id="{{bean.order_id}}" class="btn pending theme-button-welcome" wx:if="{{bean.status==1}}" data-keys="{{index}}">处理</view> -->
					</view>
				</view>

			</block>
		</view>
	</scroll-view>
</view>