<!--pages/hotel/dishes/index.wxml-->
<view class='container theme-container'>
	<view class="tab-bar flex_row_center_spaceAround theme7">
		<view class="tab take-out{{tab == 'take-out' ? ' selected' : ' theme-font3'}}" data-tab="take-out" bindtap="showTab">外卖菜品</view>
		<view class="tab nationwide{{tab == 'nationwide' ? ' selected' : ' theme-font3'}}" data-tab="nationwide" bindtap="showTab">售全国商品</view>
	</view>

	<!-- 外卖菜品 -->
	<view wx:if="{{tab == 'take-out'}}" class="tab-body take-out">
		<scroll-view class="scroll-view" scroll-y="true" scroll-with-animation="true" bindscrolltolower="loadMore">
			<view class="list flex_column_center">
				<block wx:for="{{dishes_list}}" wx:for-item="bean" wx:key="key" wx:for-index="index">
					<view class="row flex_row_center_spaceBetween theme7">
						<image class="pic" mode="aspectFill" bindtap="gotoDeshDetail" data-goods_id="{{bean.id}}" src="{{bean.img_url}}"></image>
						<view class="info flex_column_flexStart_spaceBetween">
							<view class="flex_column_flexStart_spaceBetween" bindtap="gotoDeshDetail" data-goods_id="{{bean.id}}">
								<view class="name two-line-overflow">{{bean.name}}</view>
								<view class="price theme-font5">￥{{bean.price}}</view>
							</view>
							<view class="btn-group flex_row_center_spaceBetween">
								<view class="btn on-line" wx:if="{{bean.status==1}}" bindtap="putawayDish" data-keys="{{index}}" data-goods_id="{{bean.id}}" data-status="2">已上架</view>
								<view class="btn off-line" wx:if="{{bean.status==2}}" bindtap="putawayDish" data-keys="{{index}}" data-goods_id="{{bean.id}}" data-status="1">已下架</view>
								<view class="btn theme-button-welcome" wx:if="{{bean.is_top==0 && bean.status==1}}" bindtap="setTop" data-keys="{{index}}" data-goods_id="{{bean.id}}">置顶</view>
								<view class="btn theme-button-welcome" wx:if="{{bean.is_top==1 && bean.status==1}}">已置顶</view>
								<view wx:if="{{bean.status==1}}" class="btn share-goods theme-button-welcome-dark" bindtap="openShareGoodsWindow" data-img_url="{{bean.img_url}}" data-qrCode="{{bean.qrcode_url}}" data-hotel_name="{{merchant_info.name}}" data-goods_name="{{bean.name}}" data-goods_id="{{bean.id}}">分享</view>
								<view class="btn theme-button-welcome-dark" bindtap="editDish" data-keys="{{index}}" data-goods_id="{{bean.id}}">编辑</view>
							</view>
						</view>
					</view>
				</block>
			</view>
		</scroll-view>
		<view class="page-bottom flex_row_center_spaceBetween">
			<view class="btn add-goods theme-button-welcome" bindtap="addDishes">新增菜品</view>
			<view class="btn share-shop theme-button-welcome-dark" bindtap="openShareShopWindow" data-picture="{{merchant_info.img}}" data-qrcode_url="{{merchant_info.qrfoods_url}}" data-hotel_name="{{merchant_info.name}}" data-tips="{{merchant_info.tips}}">分享店铺</view>
		</view>
	</view>

	<!-- 售全国商品 -->
	<view wx:if="{{tab == 'nationwide'}}" class="tab-body nationwide">
		<scroll-view class="scroll-view" scroll-y="true" scroll-with-animation="true" bindscrolltolower="loadMore">
			<view class="list flex_column_center">
				<view class="row flex_row_center_spaceBetween theme7" wx:for="{{goods_list}}" wx:for-item="bean" wx:key="key" wx:for-index="index">
					<image class="pic" mode="aspectFill" src="{{bean.img_url}}" bindtap="gotoDeshDetail" data-goods_id="{{bean.id}}"></image>
					<view class="info flex_column_flexStart_spaceBetween">
						<view class="name two-line-overflow" bindtap="gotoDeshDetail" data-goods_id="{{bean.id}}">{{bean.name}}</view>
						<view class="flex_row_center_spaceBetween" bindtap="gotoDeshDetail" data-goods_id="{{bean.id}}">
							<view class="price">￥{{bean.price}}</view>
							<view class="status theme-font5" wx:if="{{bean.flag==1}}">审核中……</view>
              <view class="status theme-font5" wx:if="{{bean.flag==2}}">审核通过</view>
              <view class="status theme-font5" wx:if="{{bean.flag==3}}">审核不通过 </view>
						</view>
						<view class="btn-group flex_row_center_spaceBetween">
            <block wx:if="{{bean.flag==2}}">
						    <view class="btn on-line" wx:if="{{bean.status==1}}" bindtap="putawayDish" data-keys="{{index}}" data-goods_id="{{bean.id}}" data-status="2">已上架</view>
						    <view class="btn off-line" wx:if="{{bean.status==2}}" bindtap="putawayDish" data-keys="{{index}}" data-goods_id="{{bean.id}}" data-status="1">已下架</view>
								<view class="btn theme-button-welcome" wx:if="{{bean.is_top==0 && bean.status==1}}" bindtap="setTop" data-keys="{{index}}" data-goods_id="{{bean.id}}">置顶</view>
								<view class="btn theme-button-welcome" wx:if="{{bean.is_top==1 && bean.status==1}}">已置顶</view>
              </block>
							<view wx:if="{{bean.flag==2 && bean.status==1}}" class="btn share-goods theme-button-welcome-dark" bindtap="openShareGoodsWindow" data-img_url="{{bean.img_url}}" data-qrCode="{{bean.qrcode_url}}" data-hotel_name="{{merchant_info.name}}" data-goods_name="{{bean.name}}" data-goods_id="{{bean.id}}">分享</view>
							<view class="btn theme-button-welcome-dark" bindtap="editDish" data-keys="{{index}}" data-goods_id="{{bean.id}}" wx:if="{{bean.flag!=1}}">编辑</view>
							
						</view>
					</view>
				</view>
			</view>
		</scroll-view>
		<view class="page-bottom flex_row_center_spaceBetween">
			<view class="btn add-goods theme-button-welcome" bindtap="addDishes">新增商品</view>
			<view class="btn share-shop theme-button-welcome-dark" bindtap="openShareShopWindow" data-picture="{{merchant_info.img}}" data-qrcode_url="{{merchant_info.qrgoods_url}}" data-hotel_name="{{merchant_info.name}}" data-tips="{{merchant_info.tips}}">分享店铺</view>
		</view>
	</view>

</view>

<!-- 分享菜品 -->
<bottomModal show="{{showGoodsPopWindow}}" width="100%" height='1040rpx' padding-bottom='0' background-color='#ededed' border-radius="0" title-text='' confirm-text='' cancel-text=''>
	<view class="share-window goods">
		<view class="title-bar flex_row_center_spaceBetween">
			<view class="theme-font1">菜品二维码</view>
			<view class="fa fa-close" aria-hidden="true" bindtap="closeShareGoodsWindow"></view>
		</view>
		<view class="body flex_column_center">
			<canvas canvas-id="goodsCanvas" class="share-canvas goods"></canvas>
		</view>
		<view class="foot">
			<view class="btn save theme-button-welcome" bindtap="saveShareGoodsPic">保存</view>
		</view>
	</view>
</bottomModal>

<!-- 分享店铺 -->
<bottomModal show="{{showShopPopWindow}}" width="100%" height='1040rpx' padding-bottom='0' background-color='#ededed' border-radius="0" title-text='' confirm-text='' cancel-text=''>
	<view class="share-window shop">
		<view class="title-bar flex_row_center_spaceBetween">
			<view class="theme-font1">店铺二维码</view>
			<view class="fa fa-close" aria-hidden="true" bindtap="closeShareShopWindow"></view>
		</view>
		<view class="body flex_column_center">
			<canvas canvas-id="shopCanvas" class="share-canvas shop"></canvas>
		</view>
		<view class="foot">
			<view class="btn save theme-button-welcome" bindtap="saveShareShopPic">保存</view>
		</view>
	</view>
</bottomModal>